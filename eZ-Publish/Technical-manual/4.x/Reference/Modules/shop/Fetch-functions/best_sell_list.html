<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>


<style type="text/css">
    @import url(../../../../../../../extension/ezdoc/design/doc/stylesheets/core.css);
    @import url(../../../../../../../extension/ezdoc/design/doc/stylesheets/classes.css);
    @import url(../../../../../../../extension/ezdoc/design/doc/stylesheets/doc.css);
    @import url(../../../../../../../extension/ezdoc/design/doc/stylesheets/print.css) print;</style>

<link type="text/css" rel="stylesheet" href="../../../../../../../extension/ezdoc/design/doc/stylesheets/print.css" media="print">

<!-- IE conditional comments; for bug fixes for different IE versions -->
<!--[if IE 5]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie5.css);    </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte.css); </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte-doc.css); </style> <![endif]-->
<!--[if IE 6]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6.css);    </style>     <![endif]-->

<!-- Load special stylesheet (if necessary) for newer Netscape decendants, Mozilla and Firefox, using the Gecko renderer -->
<script type="text/javascript"><!-- if ((navigator.userAgent.indexOf("Gecko") != -1)&&(navigator.userAgent.indexOf("KHTML") == -1)) document.write("<style type=\"text/css\">@import url(/extension/ezdoc/design/doc/stylesheets/gecko.css);</style>"); --></script>

<script type="text/javascript" src="../../../../../../../extension/ezdoc/design/doc/javascripts/mainmenu-hover.js"></script>
<script type="text/javascript" src="../../../../../../../extension/ezdoc/design/doc/javascripts/dropdownmenu.js"></script>
<script type="text/javascript" src="../../../../../../../extension/ezdoc/design/doc/javascripts/ezno-searchbox.js"></script>
                                                                
    <title>best_sell_list / Fetch functions / shop / Modules / Reference / 4.x / Technical manual / eZ Publish / Documentation - Doc</title>

    
    
    
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

            <meta http-equiv="Content-language" content="en-GB">

    
                <meta name="author" content="eZ systems">
                    <meta name="copyright" content="eZ systems">
                    <meta name="description" content="eZ Publish Documentation">
                    <meta name="keywords" content="eZ Publish, documentation, manual, reference, eZ systems">
        
    <meta name="generator" content="eZ Publish">
    <link rel="Home" href="https://doc.ez.no/" title="Doc front page">
<link rel="Search" href="https://doc.ez.no/content/advancedsearch" title="Search Doc">
<link rel="Shortcut icon" href="../../../../../../../extension/ezdoc/design/doc/images/favicon.ico" type="image/x-icon">

</head>
<body onload="initDocSearch();menuInit();">

<!-- Complete page area: START -->
<div id="page">


<div><a href="https://www.ibexa.co"><img class="logotype" width="100" height="50" src="/design/standard/images/ibexa_logo.svg" alt="ibexa"></a></div>
<div id="page-content-position"><div id="page-content-position-inner"><div id="page-content">

<!-- Path area: START -->
<div id="path">

<div id="page-width4">
<h2 class="hide">Path</h2>

<!-- Path content: START -->
<p><a href="/eZ-Publish/index.html">ez publish</a>
        
                        /
                            <a href="../../../../../../Technical-manual.html">technical manual</a>
        
                        /
                            <a href="../../../../../4.x.html">4.x</a>
        
                        /
                            <a href="../../../../Reference.html">reference</a>
        
                        /
                            <a href="../../../Modules.html">modules</a>
        
                        /
                            <a href="../../shop.html">shop</a>
        
                        /
                            <a href="../Fetch-functions.html">fetch functions</a>
        
                        /
                            best_sell_list
        
            </p>
<!-- Path content: END -->

</div>

</div>
<!-- Path area: END -->

<hr class="hide">

<!-- Main area: START -->
                                    <div id="ezp5disclaimer">
                <p><strong style="color: red">Caution:</strong> This documentation is for <strong>eZ Publish</strong> <em>legacy</em>, from version 3.x to 5.x.<br></p>
            </div>
            
<div id="page-width5">
<div id="main" class="float-break">


<div class="template-design area-docmenu-normal">
<div class="template-module">
<div class="template-object">
<div id="contentmenu">
                        <div class="attribute-heading"><h2 class="bullet"><a href="../../../../../4.x.html">Table of contents</a></h2></div>
<div class="boxcontent">

<map id="contentstructure">

    
                                                                        
            <ul>
	    
                                                        
                                    
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../../Installation.html" title="">
	    	    		                    		    <span class="node-name-normal">Installation</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../../Concepts-and-basics.html" title="">
	    	    		                    		    <span class="node-name-normal">Concepts and basics</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../../Templates.html" title="">
	    	    		                    		    <span class="node-name-normal">Templates</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../../Features.html" title="">
	    	    		                    		    <span class="node-name-normal">Features</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter-selected  ">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../../Reference.html" title="">
	    	    		                    		    <span class="node-name-normal">Reference</span>
                    			    	    		</a>
			           </div>
        
            <ul>
	    
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Database-schema.html" title="">
	    	    		                    		    <span class="node-name-normal">Database schema</span>
                    			    	    		</a>
			           </div>
        
            <ul>
	    
                                                    
	<li class="last">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Database-schema/Deprecated-database-fields.html" title="">
	    	    		                    		    <span class="node-name-normal">Deprecated database fields</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                            </ul>
                                        </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Datatypes.html" title="">
	    	    		                    		    <span class="node-name-normal">Datatypes</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Content-classes.html" title="">
	    	    		                    		    <span class="node-name-normal">Content classes</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Modules.html" title="">
	    	    		                    		    <span class="node-name-normal">Modules</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Views.html" title="">
	    	    		                    		    <span class="node-name-normal">Views</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Objects.html" title="">
	    	    		                    		    <span class="node-name-normal">Objects</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Workflow-events.html" title="">
	    	    		                    		    <span class="node-name-normal">Workflow events</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Template-operators.html" title="">
	    	    		                    		    <span class="node-name-normal">Template operators</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Template-functions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template functions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Template-control-structures.html" title="">
	    	    		                    		    <span class="node-name-normal">Template control structures</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Template-override-conditions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template override conditions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Template-fetch-functions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template fetch functions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Template-PDF-functions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template PDF functions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Configuration-files.html" title="">
	    	    		                    		    <span class="node-name-normal">Configuration files</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Libraries.html" title="">
	    	    		                    		    <span class="node-name-normal">Libraries</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../XML-tags.html" title="">
	    	    		                    		    <span class="node-name-normal">XML tags</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="last">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Scripts.html" title="">
	    	    		                    		    <span class="node-name-normal">Scripts</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                            </ul>
                                        </li>
            
                                            </ul>
                        
            
</map>

</div>            
</div>
</div>
</div>
</div>
<div class="area-docmain-normal">
<div class="template-design">
<div class="template-module content-view-full">
<div class="template-object">

<div class="attribute-heading">
<h1>best_sell_list</h1>
</div>
<h3>Summary</h3>
Fetches the most popular / most sold products.<h3>Usage</h3>
<pre class="wordwrap">
<span class="line">fetch( 'shop', 'best_sell_list',</span>
<span class="line">       hash( [ 'top_parent_node_id', parent_node_id, ]</span>
<span class="line">             [ 'offset',             offset,         ]</span>
<span class="line">             [ 'limit',              limit,          ]</span>
<span class="line">             [ 'start_time',         start_time,     ]</span>
<span class="line">             [ 'end_time',           end_time,       ]</span>
<span class="line">             [ 'duration',           duration,       ]</span>
<span class="line">             [ 'ascending',          ascending,      ]</span>
<span class="line">             [ 'extended',           extended        ] ) )</span>

</pre><h3>Parameters</h3><table class="list" cellspacing="0">
<tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr><tr class="bglight">
        <td>top_parent_node_id</td>
        <td>integer</td>
        <td>The ID number of the top node.</td>
        <td>Yes.</td>
    </tr><tr class="bgdark">
        <td>limit</td>
        <td>integer</td>
        <td>The number of objects that should be returned.</td>
        <td>No.</td>
    </tr><tr class="bglight">
        <td>offset</td>
        <td>integer</td>
        <td>The offset to start at.</td>
        <td>No.</td>
    </tr><tr class="bgdark">
        <td>start_time</td>
        <td>integer</td>
        <td>The time to start at.</td>
        <td>No.</td>
    </tr><tr class="bglight">
        <td>end_time</td>
        <td>integer</td>
        <td>The time to end at.</td>
        <td>No.</td>
    </tr><tr class="bgdark">
        <td>duration</td>
        <td>integer</td>
        <td>The period of time that should be used.</td>
        <td>No.</td>
    </tr><tr class="bglight">
        <td>ascending</td>
        <td>boolean</td>
        <td>The sorting direction that should be used. If FALSE (default), the results will be sorted descending by the number of times each product was bought.</td>
        <td>No.</td>
    </tr><tr class="bgdark">
        <td>extended</td>
        <td>boolean</td>
        <td>If TRUE, an array of hashes will be returned.</td>
        <td>No.</td>
    </tr></table><h3>Returns</h3>
 <p>An array of <a href="../../../Objects/ezcontentobject.html" target="_self">ezcontentobject</a> objects, an array of hashes (see below) or FALSE.</p><h3>Description</h3>
 <p>This function fetches the most popular / most sold products that are located within a specified part of the content node tree. The "top_parent_node_id" parameter must be used to tell the function under which node it should look for popular products. </p> <p>The returned result is sorted by the number of times the products were bought. The sorting direction can be controlled using the "ascending" parameter, it can be set to either TRUE or FALSE (default).</p> <p>The "limit" and "offset" parameters can be used to control the number of items returned and the offset to start at.</p> <p>The "start_time", "end_time" and "duration" parameters can be used to specify a time period that the function should operate within. These parameters make it possible to fetch the most popular/sold products for a certain period of time (for example last 24 hours, last week, last month, etc.). If the "start_time" and "duration" parameters are specified, results for the "start_time+duration" period of time will be fetched. If the "end_time" and "duration" parameters are specified, results for the "end_time-duration" period of time will be fetched. If all of these parameters are omitted, the function will cover all products, regardless when they were purchased. If both the "start_time" and "duration" parameters are omitted, then only results for the period before "end_time" will be fetched. If only the "start_time" or "duration" parameter is set, the function will automatically use the current time as the "end_time" parameter.</p> <p>By default (when the "extended" parameter is FALSE), the function returns an array of <a href="../../../Objects/ezcontentobject.html" target="_self">ezcontentobject</a> objects. If the "extended" parameter is set to TRUE, the function will return an array of the following hashes:</p> <table class="renderedtable" cellpadding="2" cellspacing="0">
 
<tr>
 <th>   <p>Key</p> 
  </th> <th>   <p>Type</p> 
  </th> <th>   <p>Description</p> 
  </th> 
</tr>
 
<tr>
 <td valign="top" style="vertical-align: top">   <p>count</p> 
  </td>
 <td valign="top" style="vertical-align: top">   <p>integer</p> 
  </td>
 <td valign="top" style="vertical-align: top">   <p>The number of times the product was bought.</p> 
  </td>
 
</tr>
 
<tr>
 <td valign="top" style="vertical-align: top">   <p>contentobject_id</p> 
  </td>
 <td valign="top" style="vertical-align: top">   <p>string</p> 
  </td>
 <td valign="top" style="vertical-align: top">   <p>The ID number of the product.</p> 
  </td>
 
</tr>
 
<tr>
 <td valign="top" style="vertical-align: top">   <p>object</p> 
  </td>
 <td valign="top" style="vertical-align: top">   <p>object</p> 
  </td>
 <td valign="top" style="vertical-align: top">   <p>The product itself (as an <a href="../../../Objects/ezcontentobject.html" target="_self">ezcontentobject</a> object).</p> 
  </td>
 
</tr>
 
</table>
 <p>If the function is unable to find any products, it will return FALSE.</p><h3>Examples</h3>
    <a name="eztoc88562_0_0_1" id="eztoc88562_0_0_1"></a><h4>Example 1</h4> <pre class="wordwrap copytoclipboard"><span class="line">{def $best_sellers=fetch( 'shop', 'best_sell_list',</span>
<span class="line">                          hash( 'top_parent_node_id', 2,</span>
<span class="line">                                'limit', 5,</span>
<span class="line">                                'offset', 0,</span>
<span class="line">                                'start_time', maketime( 0, 0, 0 ),</span>
<span class="line">                                'duration', mul( 60, 60, 24 ) ) ) }</span>
<span class="line"> </span>
<span class="line">{foreach $best_sellers as $product}</span>
<span class="line">    {$product.name}</span>
<span class="line">{/foreach}</span>
<span class="line">{undef}</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '{def $best_sellers=fetch( \'shop\', \'best_sell_list\',\r\n                          hash( \'top_parent_node_id\', 2,\r\n                                \'limit\', 5,\r\n                                \'offset\', 0,\r\n                                \'start_time\', maketime( 0, 0, 0 ),\r\n                                \'duration\', mul( 60, 60, 24 ) ) ) }                             \r\n\r\n{foreach $best_sellers as $product}\r\n    {$product.name}    \r\n{/foreach}\r\n{undef}' ); return false;" /></p>
<![endif]--> <p>Outputs the names of the five most popular products below node 2 during the last 24 hours. The "start_time" parameter sets 00:00:00 as the time and the current date. The "duration" parameter is set to a period that equals one day (60 seconds x 60 minutes x 24 hours).</p>       <a name="eztoc88562_0_0_2" id="eztoc88562_0_0_2"></a><h4>Example 2</h4> <pre class="wordwrap copytoclipboard"><span class="line">{def $best_sellers=fetch( 'shop', 'best_sell_list',</span>
<span class="line">                          hash( 'top_parent_node_id', 2,</span>
<span class="line">       'ascending', false(),</span>
<span class="line">                                'extended', true() ) ) }</span>
<span class="line"> </span>
<span class="line">&lt;table&gt;</span>
<span class="line">{foreach $best_sellers as $product}</span>
<span class="line">    &lt;tr&gt;</span>
<span class="line">    &lt;td&gt;{$product.object.name}&lt;/td&gt;</span>
<span class="line">    &lt;td&gt;{$product.object.main_node.path_identification_string}&lt;/td&gt;</span>
<span class="line">    &lt;td&gt;{$product.count}&lt;/td&gt;</span>
<span class="line">    &lt;/tr&gt;</span>
<span class="line">{/foreach}</span>
<span class="line">&lt;/table&gt;</span>
<span class="line">{undef}</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '{def $best_sellers=fetch( \'shop\', \'best_sell_list\',\r\n                          hash( \'top_parent_node_id\', 2,\r\n       \'ascending\', false(),\r\n                                \'extended\', true() ) ) }\r\n\r\n&lt;table&gt;\r\n{foreach $best_sellers as $product}\r\n    &lt;tr&gt;\r\n    &lt;td&gt;{$product.object.name}&lt;/td&gt;\r\n    &lt;td&gt;{$product.object.main_node.path_identification_string}&lt;/td&gt;\r\n    &lt;td&gt;{$product.count}&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n{/foreach}\r\n&lt;/table&gt;\r\n{undef}' ); return false;" /></p>
<![endif]--> <p>Generates a list of popular products by outputting the names, node paths and the number of times they were bought. The results are sorted by the number of times the products were bought.</p>   


<div class="break"></div><div class="pageinfo float-break">
<div class="created">


<p><label>Written by:</label>Balazs Halasy (06/02/2004 12:49 pm)</p>
</div>
<div class="modified">
<p><label>Last updated by:</label>Balazs Halasy (13/05/2007 2:02 pm)</p>
</div><div class="authors">
<p><label>Maintainers:</label>Balazs Halasy, Julia Shymova</p>
</div></div>
<hr class="hide">

</div>
</div>
</div>

<div id="comments" class="class-comment">
<div class="content-view-children">

<h1>Comments</h1>
<p>There are no comments.</p>
<div class="toolbar">


</div>

</div>
</div>

</div>
<!-- Main area content: END -->

</div>
</div>
<!-- Main area: END -->
<hr class="hide">

</div></div></div>



</div>
<!-- Complete page area: END -->











</body>
</html><!-- th[eZ] 20050804 -->
