<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


<style type="text/css">
    @import url(../../../../../../extension/ezdoc/design/doc/stylesheets/core.css);
    @import url(../../../../../../extension/ezdoc/design/doc/stylesheets/classes.css);
    @import url(../../../../../../extension/ezdoc/design/doc/stylesheets/doc.css);
    @import url(../../../../../../extension/ezdoc/design/doc/stylesheets/print.css) print;</style>

<link type="text/css" rel="stylesheet" href="../../../../../../extension/ezdoc/design/doc/stylesheets/print.css" media="print">

<!-- IE conditional comments; for bug fixes for different IE versions -->
<!--[if IE 5]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie5.css);    </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte.css); </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte-doc.css); </style> <![endif]-->
<!--[if IE 6]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6.css);    </style>     <![endif]-->

<!-- Load special stylesheet (if necessary) for newer Netscape decendants, Mozilla and Firefox, using the Gecko renderer -->
<script type="text/javascript"><!-- if ((navigator.userAgent.indexOf("Gecko") != -1)&&(navigator.userAgent.indexOf("KHTML") == -1)) document.write("<style type=\"text/css\">@import url(/extension/ezdoc/design/doc/stylesheets/gecko.css);</style>"); --></script>

<script type="text/javascript" src="../../../../../../extension/ezdoc/design/doc/javascripts/mainmenu-hover.js"></script>
<script type="text/javascript" src="../../../../../../extension/ezdoc/design/doc/javascripts/dropdownmenu.js"></script>
<script type="text/javascript" src="../../../../../../extension/ezdoc/design/doc/javascripts/ezno-searchbox.js"></script>
                                                          
    <title>cache-block / Miscellaneous / Template functions / Reference / 3.7 / Technical manual / eZ Publish / Documentation - Doc</title>

    
    
    
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

            <meta http-equiv="Content-language" content="en-GB">

    
                <meta name="author" content="eZ systems">
                    <meta name="copyright" content="eZ systems">
                    <meta name="description" content="eZ Publish Documentation">
                    <meta name="keywords" content="eZ Publish, documentation, manual, reference, eZ systems">
        
    <meta name="generator" content="eZ Publish">
    <link rel="Home" href="https://doc.ez.no/" title="Doc front page">
<link rel="Search" href="https://doc.ez.no/content/advancedsearch" title="Search Doc">
<link rel="Shortcut icon" href="../../../../../../extension/ezdoc/design/doc/images/favicon.ico" type="image/x-icon">

</head>
<body onload="initDocSearch();menuInit();">

<!-- Complete page area: START -->
<div id="page">


<div><a href="https://www.ibexa.co"><img class="logotype" width="100" height="50" src="https://ezpublishdoc.mugo.ca/design/standard/images/ibexa_logo.svg" alt="ibexa"></a></div>
<div id="page-content-position"><div id="page-content-position-inner"><div id="page-content">

<!-- Path area: START -->
<div id="path">

<div id="page-width4">
<h2 class="hide">Path</h2>

<!-- Path content: START -->
<p><a href="../index.html">ez publish</a>
        
                        /
                            <a href="../../../../../Technical-manual.html">technical manual</a>
        
                        /
                            <a href="../../../../3.7.html">3.7</a>
        
                        /
                            <a href="../../../Reference.html">reference</a>
        
                        /
                            <a href="../../Template-functions.html">template functions</a>
        
                        /
                            <a href="../Miscellaneous.html">miscellaneous</a>
        
                        /
                            cache-block
        
            </p>
<!-- Path content: END -->

</div>

</div>
<!-- Path area: END -->

<hr class="hide">

<!-- Main area: START -->
                                    <div id="ezp5disclaimer">
                <p><strong style="color: red">Caution:</strong> This documentation is for <strong>eZ Publish</strong> <em>legacy</em>, from version 3.x to 5.x.<br></p>
            </div>
            
<div id="page-width5">
<div id="main" class="float-break">


<div class="template-design area-docmenu-normal">
<div class="template-module">
<div class="template-object">
<div id="contentmenu">
                        <div class="attribute-heading"><h2 class="bullet"><a href="../../../../3.7.html">Table of contents</a></h2></div>
<div class="boxcontent">

<map id="contentstructure">

    
                                                                        
            <ul>
	    
                                                        
                                    
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Installation.html" title="">
	    	    		                    		    <span class="node-name-normal">Installation</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Concepts-and-basics.html" title="">
	    	    		                    		    <span class="node-name-normal">Concepts and basics</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Templates.html" title="">
	    	    		                    		    <span class="node-name-normal">Templates</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Features.html" title="">
	    	    		                    		    <span class="node-name-normal">Features</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter-selected  ">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../../Reference.html" title="">
	    	    		                    		    <span class="node-name-normal">Reference</span>
                    			    	    		</a>
			           </div>
        
            <ul>
	    
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Datatypes.html" title="">
	    	    		                    		    <span class="node-name-normal">Datatypes</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Content-classes.html" title="">
	    	    		                    		    <span class="node-name-normal">Content classes</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Modules.html" title="">
	    	    		                    		    <span class="node-name-normal">Modules</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Views.html" title="">
	    	    		                    		    <span class="node-name-normal">Views</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Objects.html" title="">
	    	    		                    		    <span class="node-name-normal">Objects</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Workflow-events.html" title="">
	    	    		                    		    <span class="node-name-normal">Workflow events</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Template-operators.html" title="">
	    	    		                    		    <span class="node-name-normal">Template operators</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Template-functions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template functions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Template-control-structures.html" title="">
	    	    		                    		    <span class="node-name-normal">Template control structures</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Template-override-conditions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template override conditions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Template-fetch-functions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template fetch functions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Template-PDF-functions.html" title="">
	    	    		                    		    <span class="node-name-normal">Template PDF functions</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Configuration-files.html" title="">
	    	    		                    		    <span class="node-name-normal">Configuration files</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../Libraries.html" title="">
	    	    		                    		    <span class="node-name-normal">Libraries</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="last">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../../XML-tags.html" title="">
	    	    		                    		    <span class="node-name-normal">XML tags</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                            </ul>
                                        </li>
            
                                            </ul>
                        
            
</map>

</div>            
</div>
</div>
</div>
</div>
<div class="area-docmain-normal">
<div class="template-design">
<div class="template-module content-view-full">
<div class="template-object">

<div class="attribute-heading">
<h1>cache-block</h1>
</div>
<h3>Summary</h3>
Caches the contents of a template block.<h3>Usage</h3>
<pre>{cache-block [ keys=keys                      ]
             [ expiry=expiry                  ]
             [ ignore_content_expiry          ]
             [ subtree_expiry=subtree_expiry  ]}

...

{/cache-block}
</pre><h3>Parameters</h3><table class="list" cellspacing="0">
<tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr><tr class="bglight">
        <td>keys</td>
        <td>string or array</td>
        <td>Cache key(s) - either as a string or an array of strings.</td>
        <td>No.</td>
    </tr><tr class="bgdark">
        <td>expiry</td>
        <td>integer</td>
        <td>The number of seconds that the cache should be allowed to live.</td>
        <td>No.</td>
    </tr><tr class="bglight">
        <td>ignore_content_expiry</td>
        <td>-</td>
        <td>Disables cache expiry when new content is published.</td>
        <td>No.</td>
    </tr><tr class="bgdark">
        <td>subtree_expiry</td>
        <td>string</td>
        <td>A subtree that expires the cache block.</td>
        <td>No.</td>
    </tr></table><h3>Description</h3>
 <p>This solution makes it possible to reduce the processing time of the main template ("pagelayout.tpl"), which often contains a lot of dynamic elements. It can be used to instruct the system to store and reuse cached blocks of template code based on different conditions.</p> <p>A typical example of where the "cache-block" mechanism should be used is the main menu of a site. The menu is often dynamically generated by fetching and displaying information about some nodes. It is usually the same for almost every page, therefore it should not be generated from scratch every time eZ Publish is instructed to render a page. This is where the "cache-block" solution comes in. In this particular scenario, it can be used to cache the contents of the main menu and thus reduce the processing time for each page load.</p>    <a name="eztoc22280_0_0_1" id="eztoc22280_0_0_1"></a><h4>Cache keys</h4> <p>The "keys" parameter can be used to define the uniqueness of a cache block. It must be either a string or an array of strings. By default, eZ Publish uses the name of the template and the position of the cache block as keys. This means that if the cache block is common for all cases that use the given template (normally "pagelayout.tpl"), there is no need to define any keys. However, the "keys" parameter is quite handy when it comes to relating a cache block to something specific (for example URLs, users, etc.). Please refer to the examples below for a demonstration of how this parameter can be used.</p>       <a name="eztoc22280_0_0_2" id="eztoc22280_0_0_2"></a><h4>Time based expiration</h4> <p>The "expiry" parameter makes it possible to manually specify how long a cache block should live (number of seconds). The default expiration time is two hours (this is hardcoded in the system and can not be configured). If an object is published, all blocks will automatically be expired. A value of zero will produce a cache block that will never expire.</p>       <a name="eztoc22280_0_0_3" id="eztoc22280_0_0_3"></a><h4>Content expiration</h4> <p>By default, all cache blocks will be expired whenever an object is published. If the "ignore_content_expiry" parameter is used, the cache block will not be expired when an object is published. However, it will still expire after two hours unless an alternative time is specified using the "expiry" parameter.</p>       <a name="eztoc22280_0_0_4" id="eztoc22280_0_0_4"></a><h4>Subtree expiration</h4> <p>The "subtree_expiry" parameter can be used to bind the expiration of a cache block to a certain part of the content node tree. When this is done, the block will expire if an object is published below the given subtree instead of the entire tree. In addition, it will also expire after two hours unless an alternative time is specified using the "expiry" parameter.</p>       <a name="eztoc22280_0_0_5" id="eztoc22280_0_0_5"></a><h4>Tips and tricks</h4> <p>Since cache blocks themselves also produce some overhead, too many blocks may lead to longer response times than expected. Because of this, only a few cache blocks should be used; and their keys should be as unique as possible. It is often very efficient to have two large cache blocks. One which caches all header information (title, path, etc.) and one which will take care of the bottom/footer of the page. This solution combined with a nested cache block used for the main menu (or several menus, etc.) often leads to good results. Please note that although the cache block mechanism was designed to minimize the processing of the main template, it may also be used in view templates. For example, it is possible to cache a part of a view - this is typically useful when the viewcache is frequently deleted. Another scenario is when the view cache is turned off and there is a need to create a cache on a per-user basis.</p>   <h3>Examples</h3>
    <a name="eztoc22281_0_0_1" id="eztoc22281_0_0_1"></a><h4>Example 1</h4> <pre class="wordwrap copytoclipboard"><span class="line">...</span>
<span class="line">{include uri='design:page_toppath.tpl'}</span>
<span class="line"> </span>
<span class="line">{cache-block}</span>
<span class="line">    {include uri='design:menu.tpl'}</span>
<span class="line">{/cache-block}</span>
<span class="line"> </span>
<span class="line">{$module_result.content}</span>
<span class="line"> </span>
<span class="line">{include uri='design:page_bottom.tpl'}</span>
<span class="line">...</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '...\r\n{include uri=\'design:page_toppath.tpl\'}\r\n\r\n{cache-block}\r\n    {include uri=\'design:menu.tpl\'}\r\n{/cache-block}\r\n\r\n{$module_result.content}\r\n\r\n{include uri=\'design:page_bottom.tpl\'}\r\n...' ); return false;" /></p>
<![endif]--> <p>This example demonstrates how the cache block solution can be used to cache the contents of a menu (which will be the same for all pages) in the pagelayout.</p>       <a name="eztoc22281_0_0_2" id="eztoc22281_0_0_2"></a><h4>Example 2</h4> <pre class="wordwrap"><span class="line">{cache-block expiry=130}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre> <p>This example demonstrates how to create a cache block that will expire after 130 seconds.</p>       <a name="eztoc22281_0_0_3" id="eztoc22281_0_0_3"></a><h4>Example 3</h4> <pre class="wordwrap"><span class="line">{cache-block keys=$uri_string}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre> <p>This example demonstrates how to create a cache block that will be unique for every URL.</p>       <a name="eztoc22281_0_0_4" id="eztoc22281_0_0_4"></a><h4>Example 4</h4> <pre class="wordwrap"><span class="line">{cache-block keys=array( $uri_string, $current_user.contentobject_id )}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre> <p>This example demonstrates how to create a cache block that is unique for each URL and each user.</p>       <a name="eztoc22281_0_0_5" id="eztoc22281_0_0_5"></a><h4>Example 5</h4> <pre class="wordwrap"><span class="line">{cache-block ignore_content_expiry}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre> <p>This example demonstrates how to create a cache block that will not expire when new content is published. However, it will expire every second hour unless an alternative "time to live" value is specified using the "expiry" parameter.</p>       <a name="eztoc22281_0_0_6" id="eztoc22281_0_0_6"></a><h4>Example 6</h4> <pre class="wordwrap"><span class="line">{cache-block subtree_expiry='products/'}</span>
<span class="line">...</span>
<span class="line">{/cache-block}</span>
</pre> <p>This example demonstrates how to create a cache block that will expire only if something is modified within the "products/" subtree, for example if a product is modified or a new product is published.</p>   

<div class="break"></div><div class="pageinfo float-break">
<div class="created">


<p><label>Written by:</label>Balazs Halasy (06/02/2004 1:19 pm)</p>
</div>
<div class="modified">
<p><label>Last updated by:</label>Balazs Halasy (18/09/2007 4:56 pm)</p>
</div></div>
<hr class="hide">

</div>
</div>
</div>

<div id="comments" class="class-comment">
<div class="content-view-children">

<h1>Comments</h1>
<div id="comments-content">
<ul>    <li class="comment-bglight"><div class="padding">
    <div class="content-view-line">
<div class="class-comment">

<div>

<div id="comment4075" class="attribute-heading">
<h2>$uri_string case sensitive</h2>
</div>

<div class="attribute-byline float-break">
    <p class="date">Thursday 08 December 2005 11:56:54 am</p>
    <p class="author">Tore Skobba</p>
</div>

<div class="attribute-short">
$uri_string is case sensitive, so that<br>
<br>
{cache-block keys=$uri_String} {/cache-block} equals {cache-block}{/cache-block}. Remember to use {cache-block key=$uri_string} . <br>
<br>

</div>




     


</div>


</div>
</div>    </div></li>    <li class="comment-bgdark"><div class="padding">
    <div class="content-view-line">
<div class="class-comment">

<div>

<div id="comment4076" class="attribute-heading">
<h2>If you're wondering why your cache block dont behave like they should</h2>
</div>

<div class="attribute-byline float-break">
    <p class="date">Friday 09 December 2005 11:02:45 am</p>
    <p class="author">Gabriel Ambuehl</p>
</div>

<div class="attribute-short">
Try setting {set-block scope=root variable=cache_ttl}0{/set-block} in the first line of the template.<br>
<br>
For reference, for example, <a href="http://ez.no/community/forum/developer/view_cache_trouble/" title="http://ez.no/community/forum/developer/view_cache_trouble/">http://ez.no/community/forum/developer/view_cache_trouble/</a>
</div>




     


</div>


</div>
</div>    </div></li></ul>
</div>
<div class="toolbar">


</div>

</div>
</div>

</div>
<!-- Main area content: END -->

</div>
</div>
<!-- Main area: END -->
<hr class="hide">

</div></div></div>



</div>
<!-- Complete page area: END -->











</body>
</html><!-- th[eZ] 20050804 -->
