<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>


<style type="text/css">
    @import url(../../../../extension/ezdoc/design/doc/stylesheets/core.css);
    @import url(../../../../extension/ezdoc/design/doc/stylesheets/classes.css);
    @import url(../../../../extension/ezdoc/design/doc/stylesheets/doc.css);
    @import url(../../../../extension/ezdoc/design/doc/stylesheets/print.css) print;</style>

<link type="text/css" rel="stylesheet" href="../../../../extension/ezdoc/design/doc/stylesheets/print.css" media="print">

<!-- IE conditional comments; for bug fixes for different IE versions -->
<!--[if IE 5]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie5.css);    </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte.css); </style>     <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6lte-doc.css); </style> <![endif]-->
<!--[if IE 6]>     <style type="text/css"> @import url(/extension/ezdoc/design/doc/stylesheets/ie6.css);    </style>     <![endif]-->

<!-- Load special stylesheet (if necessary) for newer Netscape decendants, Mozilla and Firefox, using the Gecko renderer -->
<script type="text/javascript"><!-- if ((navigator.userAgent.indexOf("Gecko") != -1)&&(navigator.userAgent.indexOf("KHTML") == -1)) document.write("<style type=\"text/css\">@import url(/extension/ezdoc/design/doc/stylesheets/gecko.css);</style>"); --></script>

<script type="text/javascript" src="../../../../extension/ezdoc/design/doc/javascripts/mainmenu-hover.js"></script>
<script type="text/javascript" src="../../../../extension/ezdoc/design/doc/javascripts/dropdownmenu.js"></script>
<script type="text/javascript" src="../../../../extension/ezdoc/design/doc/javascripts/ezno-searchbox.js"></script>
                                              
    <title>Installation / Content Staging / 4.7 / User manual / eZ Publish / Documentation - Doc</title>

    
    
    
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

            <meta http-equiv="Content-language" content="en-GB">

    
                <meta name="author" content="eZ systems">
                    <meta name="copyright" content="eZ systems">
                    <meta name="description" content="eZ Publish Documentation">
                    <meta name="keywords" content="eZ Publish, documentation, manual, reference, eZ systems">
        
    <meta name="generator" content="eZ Publish">
    <link rel="Home" href="https://doc.ez.no/" title="Doc front page">
<link rel="Search" href="https://doc.ez.no/content/advancedsearch" title="Search Doc">
<link rel="Shortcut icon" href="../../../../extension/ezdoc/design/doc/images/favicon.ico" type="image/x-icon">

</head>
<body onload="initDocSearch();menuInit();">

<!-- Complete page area: START -->
<div id="page">


<div><a href="https://www.ibexa.co"><img class="logotype" width="100" height="50" src="https://ibexa-lookandfeel.s3-eu-west-1.amazonaws.com/ibexa/assets/images/ibexa_logo.svg" alt="ibexa"></a></div>
<div id="page-content-position"><div id="page-content-position-inner"><div id="page-content">

<!-- Path area: START -->
<div id="path">

<div id="page-width4">
<h2 class="hide">Path</h2>

<!-- Path content: START -->
<p><a href="/eZ-Publish/index.html">ez publish</a>
        
                        /
                            <a href="../../../User-manual.html">user manual</a>
        
                        /
                            <a href="../../4.7.html">4.7</a>
        
                        /
                            <a href="../Content-Staging.html">content staging</a>
        
                        /
                            installation
        
            </p>
<!-- Path content: END -->

</div>

</div>
<!-- Path area: END -->

<hr class="hide">

<!-- Main area: START -->
                                    <div id="ezp5disclaimer">
                <p><strong style="color: red">Caution:</strong> This documentation is for <strong>eZ Publish</strong> <em>legacy</em>, from version 3.x to 5.x.<br>
                For 5.x documentation covering <em>Platform</em> see <a href="https://doc.ez.no/display/MAIN/eZ+Documentation+Center">eZ Documentation Center</a>, for difference between <em>legacy</em> and <em>Platform</em> see <a href="https://doc.ez.no/pages/viewpage.action?pageId=11403666">5.x Architecture overview</a>.</p>
            </div>
            
<div id="page-width5">
<div id="main" class="float-break">


<div class="template-design area-docmenu-normal">
<div class="template-module">
<div class="template-object">
<div id="contentmenu">
                        <div class="attribute-heading"><h2 class="bullet"><a href="../../4.7.html">Table of contents</a></h2></div>
<div class="boxcontent">

<map id="contentstructure">

    
                                                                        
            <ul>
	    
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../Multivariate-testing.html" title="">
	    	    		                    		    <span class="node-name-normal">Multivariate testing</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../The-administration-interface.html" title="">
	    	    		                    		    <span class="node-name-normal">The administration interface</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../Daily-tasks.html" title="">
	    	    		                    		    <span class="node-name-normal">Daily tasks</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="topchapter-selected  ">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../Content-Staging.html" title="">
	    	    		                    		    <span class="node-name-normal">Content Staging</span>
                    			    	    		</a>
			           </div>
        
            <ul>
	    
                                                    
	<li class="currentnode">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="Installation.html" title="">
	    	    		                    		    <span class="node-name-normal">Installation</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="Requirements.html" title="">
	    	    		                    		    <span class="node-name-normal">Requirements</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li>
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="Usage.html" title="">
	    	    		                    		    <span class="node-name-normal">Usage</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                
                                                    
	<li class="last">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="Known-limitations.html" title="">
	    	    		                    		    <span class="node-name-normal">Known limitations</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                            </ul>
                                        </li>
            
                                
                                                    
	<li class="topchapter">
	    <div>
	    
	    

	    
	    
	    
	    			    	    
	    
	    		<a class="nodetext" href="../The-object-edit-interface.html" title="">
	    	    		                    		    <span class="node-name-normal">The object edit interface</span>
                    			    	    		</a>
			           </div>
        
                                    </li>
            
                                            </ul>
                        
            
</map>

</div>            
</div>
</div>
</div>
</div>
<div class="area-docmain-normal">
<div class="template-design">
<div class="template-module content-view-full">
<div class="template-object">

<div class="attribute-heading">
<h1>Installation</h1>
</div>

<a name="eztoc135487_1" id="eztoc135487_1"></a><h2>Get the packages</h2><p>If you install the demo design package, setup is already done for you. </p><p>If you have an eZ Publish Enterprise, you'll be able to download a supported stable version for your eZ Publish Enterprise version from your service portal on <a href="http://support.ez.no/" target="_self">support.ez.no</a>.</p><a name="eztoc135487_2" id="eztoc135487_2"></a><h2>Copy the extension</h2><p>After downloading the Content Staging source code (folder named <i>ezcontentstaging</i>), you must copy <i>ezcontentstaging</i> into your eZ Publish <i>extension</i> directory.</p><a name="eztoc135487_3" id="eztoc135487_3"></a><h2>Target and Source Servers Installation</h2><a name="eztoc135487_3_1" id="eztoc135487_3_1"></a><h3>Target Server:</h3><p>1. Unzip Content Staging and enable it. Make sure to regenerate autoloads and clear caches (please refer to the end of the document for instructions);</p><p>2. Add a table in the database used by your eZ Publish instance. You can do so as follows:</p><p>    From eZ Publish root directory, in case you are using MySQL:</p><pre class="wordwrap"><span class="line">$ mysql -u &lt;user&gt; -p &lt;database_name&gt; &lt; extension/ezcontentstaging/sql/mysql/mysql.sql</span>
</pre><p><i><b>Note:</b> The procedure is very similar in case you are using another RDMS. You may want to have a look at the sql/oracle and sql/postgresql for Oracle and PostgreSQL databases respectively. Please refer to the documentation reference for your DBMS if you are experiencing issues.</i></p><p>3. Enable rewrite rules to make the REST api accessible. See the documentation <a href="../../../Technical-manual/4.5/Features/Rest-API.html" target="_self">here</a>.</p><p>4. Disable oauth authentication (use basic auth with or without https:</p><pre class="wordwrap"><span class="line">edit rest.ini.append.php:</span>
<span class="line">[Authentication]</span>
<span class="line">AuthentitacionStyle=ezpRestBasicAuthStyle</span>
</pre><p>5. Make sure there is a user account that has enough rights to create/read/update/delete any content, e.g.: admin</p><a name="eztoc135487_3_2" id="eztoc135487_3_2"></a><h3>Source Server:</h3><p>1. Unzip Content Staging and enable it. Make sure to regenerate autoloads and clear (please refer to the end of the document for instructions);</p><p>2. Add a table in the database used by your eZ Publish instance. You can do so as follows:</p><p>    From eZ Publish root directory, in case you are using MySQL:</p><pre class="wordwrap"><span class="line">$ mysql -u &lt;user&gt; -p &lt;database_name&gt; &lt; extension/ezcontentstaging/sql/mysql/mysql.sql</span>
</pre><p>  <i>  <b>Note:</b>  The procedure is very similar in case you are using another RDMS. You may want to have a look at the sql/oracle and sql/postgresql for Oracle and PostgreSQL databases respectively. Please refer to the documentation reference for your DBMS if you are experiencing issues.</i></p><p>3. Enable all the needed workflow events:</p><p>    3.1. Create one workflow per trigger for all content-related triggers</p><p>    3.2. Add, to each workflow, one event of "stage <b>&lt;XXX&gt;</b>" type</p><p>    3.3. Add each workflow to one trigger</p><p>          . add location: after</p><p>          . remove location: before</p><p>          ...</p><p>          Note that for each one of the 15 operations relating to content, 2 triggers are available: Before and After.</p><p>          You do not need to create 30 workflows, but only 15. Each workflow will be usable with the correct trigger type (either Before or After).</p><p>    3.4. If you have existing workflows (e.g.: Content Approval), insert the "stage" event where you find appropriate</p><p>4. Define target feed:</p><p>    4.1. Make sure all content classes, sections, languages, object stages, are have the same definition on source and target server (this must be done manually).</p><p>    4.2. Edit contentstagingsource.ini.append.php:</p><pre class="wordwrap copytoclipboard"><span class="line">[GeneralSettings]</span>
<span class="line">TargetList[]=&lt;feedname&gt;</span>
<span class="line">[Target_&lt;feedname&gt;]</span>
<span class="line">Name=&lt;A descriptive name for this export feed&gt;</span>
<span class="line">TransportClass=eZRestApiEmbeddedClientStagingTransport</span>
<span class="line">RemoteIdGeneratorClass=eZContentStagingSameRemoteIdGenerator</span>
<span class="line">Server=&lt;server_feedname&gt; note: this can be the same or different from feedname, but has to be the same as used in wsproviders.ini</span>
<span class="line">Subtrees[]=&lt;local_root_node_id&gt;</span>
<span class="line">RemoteSubtrees[]=&lt;target_root_node_id&gt;</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[GeneralSettings]    \r\nTargetList[]=&lt;feedname&gt;   \r\n[Target_&lt;feedname&gt;]    \r\nName=&lt;A descriptive name for this export feed&gt;    \r\nTransportClass=eZRestApiEmbeddedClientStagingTransport    \r\nRemoteIdGeneratorClass=eZContentStagingSameRemoteIdGenerator    \r\nServer=&lt;server_feedname&gt; note: this can be the same or different from feedname, but has to be the same as used in wsproviders.ini    \r\nSubtrees[]=&lt;local_root_node_id&gt;    \r\nRemoteSubtrees[]=&lt;target_root_node_id&gt;' ); return false;" /></p>
<![endif]--><p>            Make sure that for all root nodes of the feed in the source server, there is a corresponding root node on the target server</p><p>     4.3. Edit wsproviders.ini.append.php:</p><pre class="wordwrap copytoclipboard"><span class="line">[&lt;server_feedname&gt;]</span>
<span class="line">providerType=REST</span>
<span class="line">providerUri=&lt;url to rest api on target server, including the final part, eg: http://my.server.com/rest/api/contentstaging/v1&gt;</span>
<span class="line">Options[]</span>
<span class="line">Options[authType]=1 (for basic auth)</span>
<span class="line">Options[login]=&lt;username&gt;</span>
<span class="line">Options[password]=&lt;password&gt;</span>
</pre><!--[if IE]>
<p class="copytoclipboard"><img src="/extension/ezdoc/design/doc/images/copytoclipboard.gif" height="16" width="16" alt="Copy to clipboard" title="Copy to clipboard" onclick="window.clipboardData.setData( 'text', '[&lt;server_feedname&gt;]\r\nproviderType=REST\r\nproviderUri=&lt;url to rest api on target server, including the final part, eg: http://my.server.com/rest/api/contentstaging/v1&gt;\r\nOptions[]\r\nOptions[authType]=1 (for basic auth)\r\nOptions[login]=&lt;username&gt;\r\nOptions[password]=&lt;password&gt;' ); return false;" /></p>
<![endif]--><p>5. In the Administration Interface, go to the "Setup" tab and click on the "Content Staging" link, in the left-col menu. You should see the target feed listed. Click on the "Check" link to verify that it is properly setup. Click on the "Initialize Feeds" button and synchronize the event generated.        </p><a name="eztoc135487_3_3" id="eztoc135487_3_3"></a><h3>Remember to:</h3><a name="eztoc135487_3_3_1" id="eztoc135487_3_3_1"></a><h4>Activate Content Staging</h4><p>Content Staging can be activated both from the Administrator Interface and the setting file. Using the first way, you must log in to the Administrator Interface, click the <b>Setup</b> tab, then open the <b>Extensions</b> link in the left hand menu. A list will appear with all the <b>Available extensions</b>, where you must check the <b>ezcontentstaging</b> box. The click the button <b>Update</b> to activate it.</p><p>If you prefer to use the second way, open <i>settings/override/site.ini.append.php</i> and add the activation configuration under the "ExtensionSettings" section like this:</p><pre class="wordwrap"><span class="line">[ExtensionSettings]ActiveExtensions[]=ezcocontentstaging</span>
</pre><p><b>Note:</b> ezcontentstaging should be before ezwebin in site.ini.</p><a name="eztoc135487_3_3_2" id="eztoc135487_3_3_2"></a><h4>Regenerate autoload arrays</h4><p>After activating Content Staging, it is necessary to regenerate the autoload arrays. This can be done from the Administrator Interface after you have activated the extension as described in the previous step. When you have applied the changes simply click on the <b>Regenerate autoload arrays for extensions</b>.</p><p>You can also generate the autoload arrays by running the following script from your eZ Publish directory:</p><pre class="wordwrap"><span class="line">php bin/php/ezpgenerateautoloads.php -e</span>
</pre><a name="eztoc135487_3_3_3" id="eztoc135487_3_3_3"></a><h4>Clear cache</h4><p>Don't forget to clear the cache. You can clear INI and template caches from the <b>Setup</b> tab in the Administrator Interface or by running the following command from your eZ Publish directory:</p><pre class="wordwrap"><span class="line">php bin/php/ezcache.php --ini --template</span>
</pre><a name="eztoc135487_3_3_4" id="eztoc135487_3_3_4"></a><h4>Troubleshooting</h4>
<ul>
<li><div>For configuration/connectivity problems, see the "check feed" link in the Admin Interface page listing feeds</div></li><li><div>If you get error messages stating: "Response received from server is not valid (unsupported format text/html)" when trying to synchronize events, a possible cause is that you might have DebugOutput enabled on the target server. There are two ways to workaround this:
<ul>
<li><div>Disable DebugOutput on the target server (for the siteaccess used for the REST calls) or </div></li><li><div>In wsproviders.ini.append.php configuration file, force the correct content type for your server definition: </div></li>
</ul>
</div></li>
</ul>
<pre class="wordwrap"><span class="line">Options[responseType]=application/json</span>
</pre>

<div class="break"></div><div class="pageinfo float-break">
<div class="created">


<p><label>Written by:</label>Ricardo Correia (29/07/2013 9:09 am)</p>
</div>
<div class="modified">
<p><label>Last updated by:</label>Ricardo Correia (29/07/2013 9:09 am)</p>
</div></div>
<hr class="hide">

</div>
</div>
</div>

<div id="comments" class="class-comment">
<div class="content-view-children">

<h1>Comments</h1>
<p>There are no comments.</p>
<div class="toolbar">


</div>

</div>
</div>

</div>
<!-- Main area content: END -->

</div>
</div>
<!-- Main area: END -->
<hr class="hide">

</div></div></div>



</div>
<!-- Complete page area: END -->











</body>
</html><!-- th[eZ] 20050804 -->
